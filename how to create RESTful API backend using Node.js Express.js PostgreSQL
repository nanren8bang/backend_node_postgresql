Google: how to deploy node.js application on rocky linux 8

backend_node_postgresql
RESTful backend to support PostgreSQL using Node.js and JS
Step 1: upload the zip file into Rocky Linux 8.10 as below :

scp D:\jhu\New_Gemini_React_howTo\backend\gemini.zip root@192.168.56.103:\tmp
  
  [root@localhost tmp]# pwd
  /tmp 
  [root@localhost tmp]# ll 
  total 56 
    -rw-r--r--. 1 root root 48903 Dec 22 20:02 gemini.zip 
    [root@localhost tmp]# unzip gemini.zip 
    [root@localhost tmp]# cd gemini 
     
    [root@localhost gemini]# 
    [root@localhost gemini]# ll 
    total 112 
      drwxr-xr-x. 6 root root 122 Dec 10 2024 api 
      drwxr-xr-x. 2 root root 37 Nov 18 2024 _config 
      -rw-r--r--. 1 root root 577 Nov 19 2024 index.js 
      -rw-r--r--. 1 root root 526 Dec 3 2024 package.json 
      -rw-r--r--. 1 root root 100700 Dec 3 2024 package-lock.json 
      -rw-r--r--. 1 root root 1613 Dec 20 2024 ReactProjectDesign.txt
    [root@localhost gemini]#

Install Node.js as below:

List available modules: 
sudo dnf module list nodejs 
  
Enable a specific version (e.g., 24): 
sudo dnf module enable nodejs:24 
Install: sudo dnf install -y nodejs

If you got error like "Could not resolve host: mirrors.rockylinux.org " , to revole it as below:

Edit /etc/resolv.conf and temporarily add Google's DNS servers: 
  nameserver 8.8.8.8 
  nameserver 8.8.4.4

Verify installation: bash node --version npm --version

Step 2: Prepare the Application

Create a directory for your app: 
mkdir -p /tmp 
cd /tmp 

Transfer your application files (using git or scp).
  scp D:\jhu\New_Gemini_React_howTo\backend\gemini.zip root@192.168.56.103:\tmp 
  unzip gemini.zip 
    cd gemini 
    ll 
 
Install dependencies: All dependencies are listed in package.json file 
npm install all dependencies in sub folder named as "node_modules".

npm install

Now , run “node index.js” to start Gemini backend

[root@localhost gemini]# pwd
  /tmp/gemini 
[root@localhost gemini]# node index.js 

Here is routes.js location: /tmp/gemini/api 
Load service and router for: user from ./ 
  /tmp/gemini/node_modules/tedious/lib/connection.js:243 _cancelAfterRequestSent; ^

SyntaxError: Unexpected token ; at Module._compile (internal/modules/cjs/loader.js:723:23) at Object.Module._extensions..js (internal/modules/cjs/loader.js:789:10) at Module.load (internal/modules/cjs/loader.js:653:32) at tryModuleLoad (internal/modules/cjs/loader.js:593:12) at Function.Module._load (internal/modules/cjs/loader.js:585:3) at Module.require (internal/modules/cjs/loader.js:692:17) at require (internal/modules/cjs/helpers.js:25:18) at Object. (/tmp/gemini/node_modules/tedious/lib/tedious.js:57:42) at Module._compile (internal/modules/cjs/loader.js:778:30) at Object.Module._extensions..js (internal/modules/cjs/loader.js:789:10) [root@localhost gemini]#

 ABove error mesan it tried to coenct to MS SQL , but here is not MS SQL , so let tri it in Postgresql :

Google:   how to connect to postgresql using sequelize
---Getting Started
https://sequelize.org/docs/v6/getting-started/
Sequelize is available via npm (or yarn).

npm install --save sequelize

You'll also have to manually install the driver for your database of choice:

# One of the following:
$ npm install --save pg pg-hstore # Postgres  dialect: 'postgres'
$ npm install --save mysql2
$ npm install --save mariadb
$ npm install --save sqlite3
$ npm install --save tedious # Microsoft SQL Server dialect: 'mssql'
$ npm install --save oracledb # Oracle Database

Run above command and it will insert below two lines into package.json :

"pg": "^8.16.3",
"pg-hstore": "^2.3.4",

Then modify .env as below :
[root@localhost gemini]# pwd
/tmp/gemini
[root@localhost gemini]# cat .env
PORT=8080

HOST='192.168.56.101'
SQL_PORT=5432
USER='user_read'
PASSWORD='user_read'
DB='dvdretal'
DIALECT='postgres'

API_SECRET='verySecurityString4$myAPI'
[root@localhost gemini]#

try to re-start : node index.js
Got error 

Create table named as "user" as below:

CREATE TABLE "user" (
    id SERIAL PRIMARY KEY,
    name VARCHAR(30) NOT NULL,
    email VARCHAR(30) UNIQUE NOT NULL
);

INSERT INTO "user" (name, email)
VALUES
     ('John Doe', 'john.doe@example.com'),
    ('Alice Smith', 'alice@example.com'),
    ('Bob Johnson', 'bob@example.com');

dvdrental=# select *  from "user";
 id |    name     |        email
----+-------------+----------------------
  1 | John Doe    | john.doe@example.com
  2 | Alice Smith | alice@example.com
  3 | Bob Johnson | bob@example.com
(3 rows)

Steps to Enable Port 8080
Add the port permanently:
Run the following command to open port 8080 for TCP traffic in the public zone [1.4, 1.7].
bash
sudo firewall-cmd --permanent --zone=public --add-port=8080/tcp
Reload the firewall:
Apply the changes so they take effect immediately [1.4, 1.7].
bash
sudo firewall-cmd --reload
Verify the port is open:
Check that the port has been added to the active rules [1.11, 1.7].
bash
sudo firewall-cmd --list-ports

Then start the APi :  node index.js

Test useing curl :

curl -v http://192.168.56.103:8080/api/user

Get error : TypeError [ERR_INVALID_ARG_TYPE]: The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type object

Alternative: Reverse Engineering (Automated) 
To automatically create models from existing tables without manual definition, you can use the sequelize-auto tool: 

npm install  sequelize-auto
npm install -pg
# Run the tool to generate models
/tmp/gemini/node_modules/sequelize-auto/bin/sequelize-auto -h 192.168.56.101 -d dvdrental  -u user_read -x user_read -p 5432 --dialect postgres

Above command will automatically create subfilder in current directory nakded "model" and pust the sequlize mode within it .







